// Pressure v2.0.0 | Created By Stuart Yamartino | MIT License | 2015 - Present
!function(e,t){"use strict";function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u={set:function(e,t,s){y(e,t,s)},config:function(e){p.set(e)},map:function(e,t,s,n,i){return v(e,t,s,n,i)}};if(e===!1)return void console.warn("Pressure requires a window with a document");if("undefined"!=typeof u)if("function"==typeof define&&define.amd){var h=u;define(["pressure"],function(e){return e})}else if("object"===("undefined"==typeof module?"undefined":r(module))&&module.exports){var h=u;module.exports=h}else e.Pressure=u;var l=function(){function e(t,s,n){i(this,e),this.el=t,this.block=s,this.options=n,this.type=p.get("only",n),this.routeEvents(),this.preventSelect(),this.polyfill=new d(this),this.pressed=!1,this.deepPressed=!1}return o(e,[{key:"routeEvents",value:function(){var e=this;!b||"desktop"!==this.type&&"mobile"===this.type?!m||"mobile"!==this.type&&"desktop"===this.type?this.el.addEventListener(m?"touchstart":"mousedown",function(t){return e.runClosure("unsupported",t)},!1):new a(this):new f(this)}},{key:"failOrPolyfill",value:function(e){p.get("polyfill",this.options)?this.polyfill.runEvent(e):this.runClosure("unsupported",e)}},{key:"runClosure",value:function(e){this.block.hasOwnProperty(e)&&this.block[e].apply(this.el||this,Array.prototype.slice.call(arguments,1))}},{key:"preventSelect",value:function(){p.get("preventSelect",this.options)&&(this.el.style.webkitTouchCallout="none",this.el.style.webkitUserSelect="none",this.el.style.khtmlUserSelect="none",this.el.style.MozUserSelect="none",this.el.style.msUserSelect="none",this.el.style.userSelect="none")}}]),e}(),c=function(){function e(t){i(this,e),this.element=t,this.el=t.el,this.block=t.block,this.runClosure=t.runClosure}return o(e,[{key:"add",value:function(e,t){this.el.addEventListener(e,t,!1)}},{key:"setPressed",value:function(e){this.element.pressed=e}},{key:"setDeepPressed",value:function(e){this.element.deepPressed=e}},{key:"isPressed",value:function(){return this.element.pressed}},{key:"isDeepPressed",value:function(){return this.element.deepPressed}},{key:"_support",value:function(e){console.log(this.isPressed(),2),this.isPressed()===!1&&this.element.failOrPolyfill(e)}},{key:"_startPress",value:function(e){console.log(this.isPressed(),1),this.isPressed()===!1&&(this.setPressed(!0),this.runClosure("start",e))}},{key:"_startDeepPress",value:function(e){this.isPressed()&&this.isDeepPressed()===!1&&(this.setDeepPressed(!0),this.runClosure("startDeepPress",e))}},{key:"_endDeepPress",value:function(){this.isPressed()&&this.isDeepPressed()&&(this.setDeepPressed(!1),this.runClosure("endDeepPress"))}},{key:"_endPress",value:function(){this.isPressed()&&(this._endDeepPress(),this.setPressed(!1),this.runClosure("end"),this.element.polyfill.force=0)}}]),e}(),f=function(e){function t(e){i(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,e));return n.bindEvents(),n}return n(t,e),o(t,[{key:"bindEvents",value:function(){this.add("webkitmouseforcewillbegin",this._startPress.bind(this)),this.add("mousedown",this._support.bind(this)),this.add("webkitmouseforcechanged",this.change.bind(this)),this.add("webkitmouseforcedown",this._startDeepPress.bind(this)),this.add("webkitmouseforceup",this._endDeepPress.bind(this)),this.add("mouseleave",this._endPress.bind(this)),this.add("mouseup",this._endPress.bind(this))}},{key:"change",value:function(e){this.isPressed()&&e.webkitForce>0&&this.runClosure("change",this.normalizeForce(e.webkitForce),e)}},{key:"normalizeForce",value:function(e){return this.reachOne(v(e,1,3,0,1))}},{key:"reachOne",value:function(e){return e>.995?1:e}}]),t}(c),a=function(e){function t(e){i(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,e));return n.bindEvents(),n}return n(t,e),o(t,[{key:"bindEvents",value:function(){k?(this.add("touchforcechange",this.start.bind(this)),this.add("touchstart",this.support.bind(this,0)),this.add("touchend",this._endPress.bind(this))):(this.add("touchstart",this.startLegacyPress.bind(this)),this.add("touchend",this._endPress.bind(this)))}},{key:"support",value:function(e,t){this.isPressed()===!1&&(e>10?this.element.failOrPolyfill(t):(e++,setTimeout(this.support.bind(this),10,e,t)))}},{key:"start",value:function(e){e.touches.length>0&&(this._startPress(e),this.runClosure("change",this.selectTouch(e).force,e))}},{key:"startLegacyPress",value:function(){this.forceValueTest=event.touches[0].force,this.supportLegacyPress(0,event)}},{key:"supportLegacyPress",value:function(e,t){t.touches[0].force!==this.forceValueTest?(this._startPress(t),this.loopForce(t)):10>=e?(e++,setTimeout(this.supportLegacyPress.bind(this),10,e,t)):this.element.failOrPolyfill(t)}},{key:"loopForce",value:function(e){this.isPressed()&&(this.touch=this.selectTouch(e),setTimeout(this.loopForce.bind(this,e),10),this.runClosure("change",this.touch.force,e))}},{key:"selectTouch",value:function(e){if(1===e.touches.length)return this.returnTouch(e.touches[0],e);for(var t=0;t<e.touches.length;t++)if(e.touches[t].target===this.el)return this.returnTouch(e.touches[t],e)}},{key:"returnTouch",value:function(e,t){return e.force>=.5?this._startDeepPress(t):this._endDeepPress(),e}}]),t}(c),d=function(e){function t(e){i(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,e,0));return n.increment=10/p.get("polyfillSpeed",e.options),n.force=0,n}return n(t,e),o(t,[{key:"runEvent",value:function(e){this._startPress(e),this.loopForce(e)}},{key:"loopForce",value:function(e){this.isPressed()&&(this.runClosure("change",this.force,e),this.force>=.5?this._startDeepPress(e):this._endDeepPress(),this.force=this.force+this.increment>1?1:this.force+this.increment,setTimeout(this.loopForce.bind(this),10,e))}}]),t}(c),p={preventSelect:!0,only:null,polyfill:!1,polyfillSpeed:1e3,get:function(e,t){return t.hasOwnProperty(e)?t[e]:this[e]},set:function(e){for(var t in e)e.hasOwnProperty(t)&&this.hasOwnProperty(t)&&"get"!=t&&"set"!=t&&(this[t]=e[t])}},y=function(e,s){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if("string"==typeof e||e instanceof String)for(var i=t.querySelectorAll(e),o=0;o<i.length;o++)new l(i[o],s,n);else if(P(e))new l(e,s,n);else for(var o=0;o<e.length;o++)new l(e[o],s,n)},P=function(e){return"object"===("undefined"==typeof HTMLElement?"undefined":r(HTMLElement))?e instanceof HTMLElement:e&&"object"===("undefined"==typeof e?"undefined":r(e))&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},v=function(e,t,s,n,i){return(e-t)*(i-n)/(s-t)+n},b="ontouchstart"in t==!1,m="ontouchstart"in t==!0,k="ontouchforcechange"in t}("undefined"!=typeof window?window:!1,"undefined"!=typeof window?window.document:!1);