// Pressure v0.0.4 | Created By Stuart Yamartino | MIT License | 2015-Present
!function(e,t){"use strict";function s(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),u={set:function(e,t,s){p(e,t,s)},map:function(e,t,s,n,i){return m(e,t,s,n,i)}},h=function(){function e(t,s,n){o(this,e),this.element=t,this.block=s,this.type=n.hasOwnProperty("only")?n.only:null,this.options=n,this.routeEvents()}return r(e,[{key:"routeEvents",value:function(){d.mobile!==!1||"force"!==this.type&&"3d"===this.type?d.mobile!==!0||"3d"!==this.type&&"force"===this.type?this.instantFail():new l(this):new a(this)}},{key:"instantFail",value:function(){var e=this;this.element.addEventListener(d.mobile?"touchstart":"mousedown",function(){return v(e.block,"unsupported",e.element)},!1)}}]),e}(),c=function(){function e(t){o(this,e),this.element=t,this.el=t.element,this.block=t.block,this.pressed=!1,this.deepPressed=!1}return r(e,[{key:"add",value:function(e,t){this.el.addEventListener(e,t,!1)}},{key:"remove",value:function(e,t){this.el.removeEventListener(e,t)}},{key:"setPressed",value:function(e){this.pressed=e}},{key:"setDeepPressed",value:function(e){this.deepPressed=e}}]),e}(),l=function(e){function t(e){o(this,t);var s=n(this,Object.getPrototypeOf(t).call(this,e));return s.$support(),s.$start(),s.$change(),s.$end(),s}return i(t,e),r(t,[{key:"$support",value:function(){this.supportMethod=this.middleMan.bind(this),this.add("touchstart",this.supportMethod)}},{key:"middleMan",value:function(e){this.setPressed(!0),this.forceValueTest=e.touches[0].force,this.supportCallback(0,e)}},{key:"supportCallback",value:function(e,t){d.hasRun!==!1||this.shim instanceof f?d.forPressure||this.shim instanceof f?this.remove("touchstart",this.supportMethod):v(this.block,"unsupported",this.el):t.touches[0].force!==this.forceValueTest?(this.preventDefault3DTouch(),d.didSucceed("3d"),this.remove("touchstart",this.supportMethod),v(this.block,"start",this.el,t),this.changeLogic(t)):10>=e&&this.pressed?(e+=1,setTimeout(this.supportCallback.bind(this),10,e,t)):this.pressed&&(d.didFail(),this.element.options.hasOwnProperty("shim")&&1==this.element.options.shim?this.shim=new f(this.element,t):v(this.block,"unsupported",this.el))}},{key:"$start",value:function(){var e=this;this.add("touchstart",function(t){d.forPressure&&(e.setPressed(!0),e.preventDefault3DTouch(),v(e.block,"start",e.el,t))})}},{key:"$change",value:function(){this.add("touchstart",this.changeLogic.bind(this))}},{key:"changeLogic",value:function(e){d.forPressure&&this.pressed&&(this.setPressed(!0),this.runForce(e))}},{key:"$end",value:function(){var e=this;this.add("touchend",function(){d.forPressure&&(e.endDeepPress(),e.setPressed(!1),v(e.block,"end",e.el))})}},{key:"startDeepPress",value:function(e){this.deepPressed===!1&&v(this.block,"startDeepPress",this.el,e),this.setDeepPressed(!0)}},{key:"endDeepPress",value:function(){this.deepPressed===!0&&v(this.block,"endDeepPress",this.el),this.setDeepPressed(!1)}},{key:"runForce",value:function(e){this.pressed&&(this.touch=this.selectTouch(e),setTimeout(this.runForce.bind(this),10,e),v(this.block,"change",this.el,this.touch.force,e))}},{key:"selectTouch",value:function(e){if(1===e.touches.length)return this.returnTouch(e.touches[0],e);for(var t=0;t<e.touches.length;t++)if(e.touches[t].target===this.el)return this.returnTouch(e.touches[t],e)}},{key:"returnTouch",value:function(e,t){return e.force>=.5?this.startDeepPress(t):this.endDeepPress(),e}},{key:"preventDefault3DTouch",value:function(){(this.element.options.hasOwnProperty("preventDefault")===!1||this.element.options.preventDefault!==!1)&&(this.el.style.webkitTouchCallout="none",this.el.style.webkitUserSelect="none")}}]),t}(c),a=function(e){function t(e){o(this,t);var s=n(this,Object.getPrototypeOf(t).call(this,e));return s.$support(),s.$start(),s.$change(),s.$startDeepPress(),s.$endDeepPress(),s.$end(),s.preventDefaultForceTouch(),s}return i(t,e),r(t,[{key:"$support",value:function(){this.add("webkitmouseforcewillbegin",this.forceTouchEnabled),this.add("mousedown",this.supportCallback.bind(this))}},{key:"forceTouchEnabled",value:function(e){e.preventDefault(),d.didSucceed("force")}},{key:"supportCallback",value:function(e){d.forPressure===!0||this.shim instanceof f?this.remove("webkitmouseforcewillbegin",this.forceTouchEnabled):(d.didFail(),this.element.options.hasOwnProperty("shim")&&1==this.element.options.shim?this.shim=new f(this.element,e):v(this.block,"unsupported",this.el))}},{key:"$start",value:function(){var e=this;this.add("mousedown",function(t){d.forPressure&&(e.setPressed(!0),v(e.block,"start",e.el,t))})}},{key:"$change",value:function(){var e=this;this.add("webkitmouseforcechanged",function(t){d.forPressure&&0!==t.webkitForce&&e.pressed&&v(e.block,"change",e.el,e.normalizeForce(t.webkitForce),t)})}},{key:"$end",value:function(){var e=this;this.add("mouseup",function(){d.forPressure&&(e.setPressed(!1),v(e.block,"end",e.el))}),this.add("mouseleave",function(){d.forPressure&&(e.pressed&&v(e.block,"end",e.el),e.setPressed(!1))})}},{key:"$startDeepPress",value:function(){var e=this;this.add("webkitmouseforcedown",function(t){d.forPressure&&(e.setDeepPressed(!0),v(e.block,"startDeepPress",e.el,t))})}},{key:"$endDeepPress",value:function(){var e=this;this.add("webkitmouseforceup",function(){d.forPressure&&(e.setDeepPressed(!1),v(e.block,"endDeepPress",e.el))}),this.add("mouseleave",function(){d.forPressure&&(e.deepPressed&&v(e.block,"endDeepPress",e.el),e.setDeepPressed(!1))})}},{key:"preventDefaultForceTouch",value:function(){var e=this;this.add("webkitmouseforcewillbegin",function(t){d.forPressure&&(e.element.options.hasOwnProperty("preventDefault")===!1||e.element.options.preventDefault!==!1)&&(t.preventDefault(),e.el.style.webkitUserSelect="none")})}},{key:"normalizeForce",value:function(e){return m(e,1,3,0,1)}}]),t}(c),f=function(e){function t(e,s){o(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,e));return i.$start(),i.$change(),i.$end(),i.force=0,i.increment=.01,i.firstRun(s),i}return i(t,e),r(t,[{key:"firstRun",value:function(e){this.preventDefaultShim(e),this.startLogic(e),this.changeLogic(e)}},{key:"$start",value:function(){var e=this;this.add(d.mobile?"touchstart":"mousedown",function(t){e.startLogic(t)})}},{key:"startLogic",value:function(e){this.setPressed(!0),v(this.block,"start",this.el,e)}},{key:"$change",value:function(){this.add(d.mobile?"touchstart":"mousedown",this.changeLogic.bind(this))}},{key:"changeLogic",value:function(e){this.pressed&&(this.setPressed(!0),this.runForce(e))}},{key:"$end",value:function(){var e=this;this.add(d.mobile?"touchend":"mouseup",function(){e.endDeepPress(),e.setPressed(!1),v(e.block,"end",e.el),e.force=0}),this.add("mouseleave",function(){e.endDeepPress(),e.pressed&&v(e.block,"end",e.el),e.setPressed(!1),e.force=0})}},{key:"startDeepPress",value:function(e){this.deepPressed===!1&&v(this.block,"startDeepPress",this.el,e),this.setDeepPressed(!0)}},{key:"endDeepPress",value:function(){this.deepPressed===!0&&v(this.block,"endDeepPress",this.el),this.setDeepPressed(!1)}},{key:"runForce",value:function(e){this.pressed&&(v(this.block,"change",this.el,this.force,e),this.force>=.5?this.startDeepPress(e):this.endDeepPress(),this.force=this.force+this.increment>1?1:this.force+this.increment,setTimeout(this.runForce.bind(this),10,e))}},{key:"preventDefaultShim",value:function(e){(this.element.options.hasOwnProperty("preventDefault")===!1||this.element.options.preventDefault!==!1)&&(e.preventDefault(),this.el.style.webkitTouchCallout="none",this.el.style.userSelect="none",this.el.style.webkitUserSelect="none",this.el.style.MozUserSelect="none")}}]),t}(c),d={hasRun:!1,forPressure:!1,type:!1,mobile:"ontouchstart"in t,didFail:function(){this.hasRun=!0,this.forPressure=!1},didSucceed:function(e){this.hasRun=!0,this.forPressure=!0,this.type=e}},p=function(e,s){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if("string"==typeof e||e instanceof String)for(var i=t.querySelectorAll(e),o=0;o<i.length;o++)new h(i[o],s,n);else if(y(e))new h(e,s,n);else for(var o=0;o<e.length;o++)new h(e[o],s,n)},y=function(e){return"object"===("undefined"==typeof HTMLElement?"undefined":s(HTMLElement))?e instanceof HTMLElement:e&&"object"===("undefined"==typeof e?"undefined":s(e))&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},v=function(e,t,s){e.hasOwnProperty(t)&&e[t].apply(s||this,Array.prototype.slice.call(arguments,3))},m=function(e,t,s,n,i){return(e-t)*(i-n)/(s-t)+n};if(e===!1)throw new Error("Pressure requires a window with a document");if("undefined"!=typeof u)if("function"==typeof define&&define.amd){var b=u;define(["pressure"],function(e){return e})}else if("object"===("undefined"==typeof module?"undefined":s(module))&&module.exports){var b=u;module.exports=b}else e.Pressure=u}("undefined"!=typeof window?window:!1,"undefined"!=typeof window?window.document:!1);