// Pressure v0.0.2 alpha | Created By Stuart Yamartino | MIT License | 2015 
!function(e){"use strict";function t(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),i=e!==!1?e.document:!1,u={set:function(e,t,n){p(e,t,null,n)},setForceTouch:function(e,t,n){p(e,t,"force",n)},set3DTouch:function(e,t,n){p(e,t,"3d",n)},interpolate:function(e,t,n,s,r){return(e-t)*(r-s)/(n-t)+s},map:function(){return this.interpolate.apply(this,arguments)}},c=function(){function e(t,n,s){r(this,e),this.element=t,this.block=n,this.type=s}return o(e,[{key:"routeEvents",value:function(){f.mobile!==!1||"force"!==this.type&&"3d"===this.type?f.mobile!==!0||"3d"!==this.type&&"force"===this.type?this.failEvents():this.touch3DAdapter():this.touchForceAdapter()}},{key:"touchForceAdapter",value:function(){var e=new a(new d(this));e.handle()}},{key:"touch3DAdapter",value:function(){var e=new a(new l(this));e.handle()}},{key:"failEvents",value:function(){var e=this;f.mobile?this.element.addEventListener("touchstart",function(){return b(e.block,"unsupported",e.element)},!1):this.element.addEventListener("mousedown",function(){return b(e.block,"unsupported",e.element)},!1)}}]),e}(),a=function(){function e(t){r(this,e),this.adapter=t}return o(e,[{key:"handle",value:function(){this.adapter.support(),this.adapter.block.hasOwnProperty("start")&&this.adapter.start(),this.adapter.block.hasOwnProperty("change")&&this.adapter.change(),this.adapter.block.hasOwnProperty("end")&&this.adapter.end(),this.adapter.block.hasOwnProperty("startDeepPress")&&this.adapter.startDeepPress(),this.adapter.block.hasOwnProperty("endDeepPress")&&this.adapter.endDeepPress()}}]),e}(),h=function(){function e(t){r(this,e),this.element=t,this.el=t.element,this.block=t.block,this.down=!1}return o(e,[{key:"add",value:function(e,t){this.el.addEventListener(e,t,!1)}},{key:"remove",value:function(e,t){this.el.removeEventListener(e,t)}},{key:"_dispatch",value:function(){f.forPressure?this.remove("webkitmouseforcewillbegin",this._touchForceEnabled):(f.didFail(),b(this.block,"unsupported",this.el))}},{key:"_setDown",value:function(){this.down=!0}},{key:"_setUp",value:function(){this.down=!1}}]),e}(),l=function(e){function t(e){r(this,t);var s=n(this,Object.getPrototypeOf(t).call(this,e));return s._startDeepPressSetEnabled=!1,s._endDeepPressSetEnabled=!1,s._inDeepPress=!1,s}return s(t,e),o(t,[{key:"support",value:function(){this.add("touchstart",this._dispatch.bind(this))}},{key:"_dispatch",value:function(e){void 0!==e.touches[0].force?(f.didSucceed("3d"),this.remove("touchstart",this._dispatch.bind(this))):(f.didFail(),b(this.block,"unsupported",this.el))}},{key:"start",value:function(){var e=this;this.add("touchstart",function(){f.forPressure&&b(e.block,"start",e.el)})}},{key:"change",value:function(){var e=this;this.add("touchstart",function(t){f.forPressure&&(e._setDown(),e.touch=e._selectTouch(t),e.touch&&e._fetchForce(t))})}},{key:"end",value:function(){var e=this;this.add("touchend",function(){f.forPressure&&(e._setUp(),b(e.block,"end",e.el))})}},{key:"startDeepPress",value:function(){this._startDeepPressSetEnabled=!0}},{key:"endDeepPress",value:function(){this._endDeepPressSetEnabled=!0}},{key:"_callStartDeepPress",value:function(){this._startDeepPressSetEnabled===!0&&(this._inDeepPress===!1?b(this.block,"startDeepPress",this.el):this._inDeepPress=!0)}},{key:"_callEndDeepPress",value:function(){this._endDeepPressSetEnabled===!0&&(this._inDeepPress===!0?b(this.block,"endDeepPress",this.el):this._inDeepPress=!1)}},{key:"_fetchForce",value:function(e){this.down&&(this.touch=this._selectTouch(e),setTimeout(this._fetchForce.bind(this),10,e),b(this.block,"change",this.el,this.touch.force,e))}},{key:"_selectTouch",value:function(e){if(1===e.touches.length)return e.touches[0];for(var t=0;t<e.touches.length;t++)if(e.touches[t].target===this.el)return e.touches[t]>=.5?this._callStartDeepPress():this._callEndDeepPress(),e.touches[t]}}]),t}(h),d=function(e){function t(e){r(this,t);var s=n(this,Object.getPrototypeOf(t).call(this,e));return s._preventDefaultForceTouch(),s}return s(t,e),o(t,[{key:"support",value:function(){this.add("webkitmouseforcewillbegin",this._touchForceEnabled),this.add("mousedown",this._dispatch.bind(this))}},{key:"_touchForceEnabled",value:function(e){e.preventDefault(),f.didSucceed("force")}},{key:"_dispatch",value:function(){f.forPressure?this.remove("webkitmouseforcewillbegin",this._touchForceEnabled):(f.didFail(),b(this.block,"unsupported",this.el))}},{key:"start",value:function(){var e=this;this.add("mousedown",function(){f.forPressure&&(e._setDown(),b(e.block,"start",e.el))})}},{key:"change",value:function(){var e=this;this.add("webkitmouseforcechanged",function(t){f.forPressure&&0!==t.webkitForce&&b(e.block,"change",e.el,e._normalizeForce(t.webkitForce),t)})}},{key:"end",value:function(){var e=this;this.add("mouseup",function(){f.forPressure&&(e._setUp(),b(e.block,"end",e.el))}),this.add("mouseleave",function(){f.forPressure&&(e.down===!0&&b(e.block,"end",e.el),e._setUp())})}},{key:"startDeepPress",value:function(){var e=this;this.add("webkitmouseforcedown",function(){f.forPressure&&b(e.block,"startDeepPress",e.el)})}},{key:"endDeepPress",value:function(){var e=this;this.add("webkitmouseforceup",function(){f.forPressure&&b(e.block,"endDeepPress",e.el)}),this.add("mouseleave",function(){f.forPressure&&(e.down===!0&&b(e.block,"endDeepPress",e.el),e._setUp())})}},{key:"_preventDefaultForceTouch",value:function(){this.add("webkitmouseforcewillbegin",function(e){f.forPressure&&e.preventDefault()})}},{key:"_normalizeForce",value:function(e){return(e-1)/2}}]),t}(h),f={hasRun:!1,forPressure:!1,type:!1,didFail:function(){this.hasRun=!0,this.forPressure=!1},didSucceed:function(e){this.hasRun=!0,this.forPressure=!0,this.type=e}},p=function(e,t,n){for(var s=arguments.length<=3||void 0===arguments[3]?!0:arguments[3],r=i.querySelectorAll(e),o=0;o<r.length;o++){s&&(r[o].style.webkitUserSelect="none");var u=new c(r[o],t,n);u.routeEvents()}},b=function(e,t,n){e.hasOwnProperty(t)&&e[t].apply(n||this,Array.prototype.slice.call(arguments,3))};if(f.mobile="ontouchstart"in i,e===!1)throw new Error("Pressure requires a window with a document");"object"===("undefined"==typeof module?"undefined":t(module))&&"object"===t(module.exports)?module.exports=u:e.Pressure=u}("undefined"!=typeof window?window:!1);