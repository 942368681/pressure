// Pressure v0.0.1 alpha | Created By Stuart Yamartino | MIT License | 2015 
!function(e,t){function o(){this.touchDown=!1}var r={set:function(e,t){n.set(e,t)},setForceTouch:function(e,t){n.set(e,t,"force")},set3DTouch:function(e,t){n.set(e,t,"3d")},support:function(e){u.checkSupport(e)},supportForceTouch:function(e){u.checkSupport(e,"force")},support3DTouch:function(e){u.checkSupport(e,"3d")}},n={set:function(e,t,o){c.build(e,t,function(){"force"===s.type&&"force"===o?c.changeForceTouch(e,t):"3d"===s.type&&"3d"===o?c.change3DTouch(e,t):"force"===s.type&&"3d"!==o?c.changeForceTouch(e,t):"3d"===s.type&&"force"!==o&&c.change3DTouch(e,t)}.bind(this))},support:function(e,t){"force"===t||"3d"===t||u.checkSupport(e)}},c={build:function(e,t,o){s.forPressure?o():s.hasRun?h(t)(a()):u.checkSupport({success:function(){o()},fail:h(t)})},changeForceTouch:function(e,t){p(f(e),function(e,o){o.addEventListener("webkitmouseforcechanged",function(e){i(t).call(o,e.webkitForce,e)},!1),o.addEventListener("webkitmouseforcewillbegin",function(e){e.preventDefault()}),t.hasOwnProperty("forceEnd")&&(o.addEventListener("mouseup",function(){t.forceEnd.call(o)}),o.addEventListener("mouseleave",function(){t.forceEnd.call(o)}))})},change3DTouch:function(e,t){p(f(e),function(e,r){var n=new o;r.addEventListener("touchstart",function(e){n.startCheckingForce(e,t,r)},!1),r.addEventListener("touchend",function(e){n.up()},!1)})}},u={checkSupport:function(e,t){!this.browserForceSupported()&&!this.browser3DSupported()||s.hasRun?s.hasRun||(s.browserFail(),this.browserForceSupported()&&"3d"===t?d(e,"failInstant",a(t+"-maybe")):this.browser3DSupported()&&"force"===t?d(e,"failInstant",a(t+"-maybe")):d(e,"failInstant",a())):this.testDeviceSupport(e,t)},browserForceSupported:function(){return"onwebkitmouseforcewillbegin"in t},browser3DSupported:function(){return"ontouchstart"in t},testDeviceSupport:function(e,t){s.forPressure=!1,this.returnSupportBind=this.returnSupport.bind(this,e,t),this.addMouseEvents(),this.addTouchEvents()},addTouchEvents:function(){t.addEventListener("webkitmouseforcewillbegin",this.touchForceEnabled,!1),t.addEventListener("mousedown",this.returnSupportBind,!1)},addMouseEvents:function(){t.addEventListener("touchstart",this.touch3DEnabled,!1),t.addEventListener("touchstart",this.returnSupportBind,!1)},removeDocumentListeners:function(){t.removeEventListener("webkitmouseforcewillbegin",this.touchForceEnabled),t.removeEventListener("mousedown",this.returnSupportBind),t.removeEventListener("touchstart",this.touch3DEnabled),t.removeEventListener("touchstart",this.returnSupportBind)},touchForceEnabled:function(){s.didSucceed("force")},touch3DEnabled:function(e){void 0!==e.touches[0].force&&s.didSucceed("3d")},returnSupport:function(e,t){this.removeDocumentListeners(),"force"===s.type&&"3d"===t?d(e,"failLater",a(t)):"3d"===s.type&&"force"===t?d(e,"failLater",a(t)):s.forPressure?d(e,"success"):(s.deviceFail(),d(e,"failLater",a()))}};o.prototype.down=function(){this.touchDown=!0},o.prototype.up=function(){this.touchDown=!1},o.prototype.startCheckingForce=function(e,t,o){this.element=o,this.down(),this.touch=e.touches[0],this.touch&&this.fetchForce(e,t)},o.prototype.fetchForce=function(e,t){this.touchDown&&(this.touch=e.touches[0],setTimeout(this.fetchForce.bind(this),10,e,t),t.call(this.element,this.touch.force||0,e))};var s={hasRun:!1,forPressure:!1,type:"",failureType:"",browserFail:function(){this.didFail("browser")},deviceFail:function(){this.didFail("device")},didFail:function(e){this.hasRun=!0,this.forPressure=!1,this.failureType=e},didSucceed:function(e){this.hasRun=!0,this.forPressure=!0,this.type=e}},i=function(e){return l(e)?e.hasOwnProperty("success")?e.success:void 0:e},h=function(e){var t=function(){};return l(e)&&e.hasOwnProperty("fail")&&(t=e.fail),t},a=function(e){var t=e||s.failureType;switch(t){case"browser":var o="Browser does not support Force Touch or 3D Touch.";break;case"device":var o="Device does not support Force Touch or 3D Touch.";break;case"3d":var o="Browser does support Force Touch but not 3D Touch.";break;case"force":var o="Browser does support 3D Touch but not Force Touch.";break;case"3d-maybe":var o="Browser may support Force Touch but not 3D Touch.";break;case"force-maybe":var o="Browser may support 3D Touch but not Force Touch."}return{error:{type:t,message:o}}},d=function(e,t){e.hasOwnProperty(t)&&e[t].apply(this,Array.prototype.slice.call(arguments,2))},f=function(e){return t.querySelectorAll(e)},p=function(e,t,o){for(var r=0;r<e.length;r++)t.call(o,r,e[r])},l=function(e){return null!==e&&"object"==typeof e};e.Pressure=r}(window,document);