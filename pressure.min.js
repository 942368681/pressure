// Pressure v0.0.1 alpha | Created By Stuart Yamartino | MIT License | 2015 
!function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),i={set:function(e,t){o.set(e,t)},setForceTouch:function(e,t){o.set(e,t,"force")},set3DTouch:function(e,t){o.set(e,t,"3d")}},o={set:function(e,t,n){a(e,function(e,s){var i=new u(s,t,n);i.routeEvents()})}},u=function(){function e(t,s,i){n(this,e),this.element=t,this.block=s,this.type=i}return s(e,[{key:"routeEvents",value:function(){r.mobile===!1&&"force"===this.type?this.addMouseEvents():r.mobile===!0&&"3d"===this.type?this.addTouchEvents():r.mobile===!1&&"3d"!==this.type?this.addMouseEvents():r.mobile===!0&&"force"!==this.type?this.addTouchEvents():this.failEvents()}},{key:"addMouseEvents",value:function(){this.element.addEventListener("webkitmouseforcewillbegin",this.touchForceEnabled,!1),this.always();var e=new c(this);e.bindEvents()}},{key:"addTouchEvents",value:function(){this.element.addEventListener("touchstart",this.touch3DEnabled,!1),this.always()}},{key:"always",value:function(){r.mobile?this.element.addEventListener("touchstart",this.dispatch.bind(this),!1):this.element.addEventListener("mousedown",this.dispatch.bind(this),!1)}},{key:"failEvents",value:function(){var e=this;r.mobile?this.element.addEventListener("mousedown",function(){return h(e.block,"unsupported")},!1):this.element.addEventListener("touchstart",function(){return h(e.block,"unsupported")},!1)}},{key:"touchForceEnabled",value:function(e){e.preventDefault(),r.didSucceed("force")}},{key:"touch3DEnabled",value:function(e){void 0!==e.touches[0].force&&r.didSucceed("3d")}},{key:"dispatch",value:function(){r.forPressure?(this.element.removeEventListener("webkitmouseforcewillbegin",this.touchForceEnabled),this.element.removeEventListener("touchstart",this.touch3DEnabled)):(r.didFail(),h(this.block,"unsupported",this.element))}}]),e}(),c=(function(){function e(t){n(this,e),this.el=t,this.touchDown=!1}return s(e,[{key:"bindEvents",value:function(){this.start(),this.change(),this.end()}},{key:"start",value:function(){el.element.hasOwnProperty("start")&&el.element.addEventListener("touchstart",function(){h(el.element.block,"start")},!1)}},{key:"change",value:function(){el.element.block.hasOwnProperty("change")&&el.element.addEventListener("touchstart",function(e){this.down(),this.touch=e.touches[0],this.touch&&this.fetchForce(e),h(el.element.block,"start")},!1)}},{key:"end",value:function(){el.element.hasOwnProperty("end")&&el.element.addEventListener("touchend",function(){this.touchDown=!1,h(el.element.block,"end")},!1)}},{key:"fetchForce",value:function(e){this.touchDown&&(this.touch=e.touches[0],setTimeout(this.fetchForce.bind(this),10,e),h(el.element.block,"change",this.touch.force||0,e))}}]),e}(),function(){function e(t){n(this,e),this.element=t,this.el=t.element,this.block=t.block,this.state="up"}return s(e,[{key:"bindEvents",value:function(){this.start(),this.change(),this.end(),this.preventDefaultForceTouch()}},{key:"start",value:function(){var e=this;this.block.hasOwnProperty("start")&&this.el.addEventListener("mousedown",function(){r.forPressure&&(e.setDown(),h(e.block,"start",e.el))},!1)}},{key:"change",value:function(){var e=this;this.block.hasOwnProperty("change")&&this.el.addEventListener("webkitmouseforcechanged",function(t){r.forPressure&&h(e.block,"change",e.el,t.webkitForce,t)},!1)}},{key:"end",value:function(){var e=this;this.block.hasOwnProperty("end")&&(this.el.addEventListener("mouseup",function(){r.forPressure&&(e.setUp(),h(e.block,"end",e.el))},!1),this.el.addEventListener("mouseleave",function(){r.forPressure&&("down"===e.state&&h(e.block,"end",e.el),e.setUp())},!1))}},{key:"preventDefaultForceTouch",value:function(){this.el.addEventListener("webkitmouseforcewillbegin",function(e){r.forPressure&&e.preventDefault()},!1)}},{key:"setUp",value:function(){this.state="up"}},{key:"setDown",value:function(){this.state="down"}}]),e}()),r={hasRun:!1,forPressure:!1,type:!1,didFail:function(){this.hasRun=!0,this.forPressure=!1},didSucceed:function(e){this.hasRun=!0,this.forPressure=!0,this.type=e}},h=function(e,t,n){e.hasOwnProperty(t)&&e[t].apply(n||this,Array.prototype.slice.call(arguments,3))},l=function(e){return t.querySelectorAll(e)},a=function(e,t,n){for(var s=l(e),i=0;i<s.length;i++)t.call(n,i,s[i])};r.mobile="ontouchstart"in t,e.Pressure=i}(window,document);